<!DOCTYPE html>
<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zenith Pro Ultra | Ultimate Quran Experience</title>
    
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&family=Amiri+Quran&family=Noto+Serif:wght@400;700&family=Scheherazade+New:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
    /* ══════════════════════════════════════
       ZENITH PRO ULTRA - CORE DESIGN SYSTEM
    ══════════════════════════════════════ */
    :root {
      --sidebar-w: 320px;
      --hud-h: 90px;
      --radius: 16px;
      --transition: 0.25s cubic-bezier(0.4, 0, 0.2, 1);
      
      /* Colors - Deep Dark Theme */
      --bg: #05070a;
      --sidebar: #0a0d14;
      --card: #11151d;
      --card-hover: #1a1f29;
      --accent: #3d8bff;
      --accent-glow: rgba(61, 139, 255, 0.3);
      --text: #f0f2f5;
      --text-dim: #94a3b8;
      --border: rgba(255, 255, 255, 0.06);
      --glass: rgba(10, 13, 20, 0.8);
    }

    [data-theme="light"] {
      --bg: #f8fafc;
      --sidebar: #ffffff;
      --card: #ffffff;
      --card-hover: #f1f5f9;
      --accent: #2563eb;
      --accent-glow: rgba(37, 99, 235, 0.1);
      --text: #0f172a;
      --text-dim: #64748b;
      --border: rgba(0, 0, 0, 0.08);
      --glass: rgba(255, 255, 255, 0.8);
    }

    * {
      margin: 0; padding: 0; box-sizing: border-box;
      outline: none; -webkit-tap-highlight-color: transparent;
    }

    body {
      background: var(--bg);
      color: var(--text);
      font-family: 'Plus+Jakarta+Sans', sans-serif;
      overflow: hidden; /* Controlled by main scroll area */
      line-height: 1.6;
    }

    /* Scrollbar */
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { 
      background: var(--border); 
      border-radius: 10px; 
    }
    ::-webkit-scrollbar-thumb:hover { background: var(--text-dim); }

    /* Layout Wrapper */
    .app-container {
      display: grid;
      grid-template-columns: var(--sidebar-w) 1fr;
      height: 100vh;
      width: 100vw;
    }

    /* Sidebar Navigation */
    .sidebar {
      background: var(--sidebar);
      border-right: 1px solid var(--border);
      display: flex;
      flex-direction: column;
      height: 100vh;
      z-index: 100;
    }

    .sidebar-header {
      padding: 24px;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .logo-icon {
      width: 40px;
      height: 40px;
      background: var(--accent);
      border-radius: 10px;
      display: grid;
      place-items: center;
      color: white;
      box-shadow: 0 4px 15px var(--accent-glow);
    }

    .search-box {
      padding: 0 20px 20px;
    }

    .search-input-wrapper {
      position: relative;
      background: var(--card);
      border-radius: var(--radius);
      border: 1px solid var(--border);
      padding: 10px 14px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .search-input-wrapper input {
      background: transparent;
      border: none;
      color: var(--text);
      width: 100%;
      font-size: 0.9rem;
    }

    .nav-scroll {
      flex: 1;
      overflow-y: auto;
      padding: 0 12px 100px;
    }

    .nav-item {
      padding: 12px 16px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      gap: 16px;
      cursor: pointer;
      transition: var(--transition);
      margin-bottom: 4px;
      border: 1px solid transparent;
    }

    .nav-item:hover {
      background: var(--card-hover);
      transform: translateX(4px);
    }

    .nav-item.active {
      background: var(--accent-glow);
      border-color: var(--accent);
      color: var(--accent);
    }

    .nav-number {
      font-size: 0.75rem;
      font-weight: 800;
      opacity: 0.5;
      width: 24px;
    }

    .nav-info { flex: 1; }
    .nav-name { font-weight: 600; font-size: 0.95rem; }
    .nav-sub { font-size: 0.75rem; opacity: 0.6; }

    /* Main Content Area */
    .main-content {
      height: calc(100vh - var(--hud-h));
      overflow-y: auto;
      position: relative;
      scroll-behavior: smooth;
    }
       /* ══════════════════════════════════════
       SURAH VIEW & AYAH CARDS
    ══════════════════════════════════════ */
    .view-container {
      max-width: 900px;
      margin: 0 auto;
      padding: 60px 24px 150px;
    }

    .surah-header {
      text-align: center;
      margin-bottom: 80px;
      padding: 40px;
      background: var(--card);
      border-radius: 30px;
      border: 1px solid var(--border);
    }

    .surah-header h1 {
      font-family: 'Amiri Quran', serif;
      font-size: 4rem;
      color: var(--accent);
      margin-bottom: 10px;
    }

    .ayah-card {
      background: var(--card);
      border-radius: var(--radius);
      padding: 40px;
      margin-bottom: 24px;
      border: 1px solid var(--border);
      transition: var(--transition);
      position: relative;
      overflow: hidden;
    }

    .ayah-card:hover {
      border-color: var(--accent);
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }

    .ayah-number-badge {
      position: absolute;
      top: 20px;
      left: 20px;
      font-size: 0.7rem;
      font-weight: 800;
      color: var(--accent);
      background: var(--accent-glow);
      padding: 4px 10px;
      border-radius: 20px;
    }

    .ayah-arabic {
      font-family: 'Scheherazade New', serif;
      font-size: 2.5rem;
      line-height: 2.2;
      text-align: right;
      margin-bottom: 30px;
      direction: rtl;
    }

    .ayah-english {
      font-family: 'Noto Serif', serif;
      font-size: 1.1rem;
      color: var(--text-dim);
      line-height: 1.8;
      border-left: 3px solid var(--border);
      padding-left: 20px;
    }

    /* ══════════════════════════════════════
       HUD (AUDIO PLAYER)
    ══════════════════════════════════════ */
    .hud {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      height: var(--hud-h);
      background: var(--glass);
      backdrop-filter: blur(20px);
      border-top: 1px solid var(--border);
      display: grid;
      grid-template-columns: 320px 1fr 320px;
      align-items: center;
      padding: 0 30px;
      z-index: 1000;
    }

    .hud-info { display: flex; align-items: center; gap: 15px; }
    .hud-controls { display: flex; align-items: center; justify-content: center; gap: 25px; }
    
    .play-btn {
      width: 50px;
      height: 50px;
      background: var(--accent);
      border-radius: 50%;
      display: grid;
      place-items: center;
      color: white;
      cursor: pointer;
      box-shadow: 0 0 20px var(--accent-glow);
    }

    .progress-bar {
      position: absolute;
      top: 0;
      left: 0;
      height: 3px;
      background: var(--accent);
      width: 0%;
      transition: width 0.1s linear;
    }

    /* Hero Section */
    .hero {
      position: relative;
      padding: 100px 40px;
      text-align: center;
      background: radial-gradient(circle at top right, var(--accent-glow), transparent);
      border-bottom: 1px solid var(--border);
      overflow: hidden;
    }

    .hero-orb {
      position: absolute;
      width: 300px;
      height: 300px;
      background: var(--accent);
      filter: blur(120px);
      opacity: 0.15;
      z-index: -1;
    }

    .hero-title { font-size: 3.5rem; font-weight: 800; margin-bottom: 10px; }

    button {
      background: none; border: none; color: inherit; cursor: pointer;
    }
    </style>
</head>
<body>

<div class="app-container">
    <aside class="sidebar">
        <div class="sidebar-header">
            <div class="logo-icon"><i data-lucide="zap"></i></div>
            <div style="font-weight: 800; letter-spacing: -0.5px;">ZENITH PRO</div>
        </div>
        
        <div class="search-box">
            <div class="search-input-wrapper">
                <i data-lucide="search" size="18" style="opacity: 0.5;"></i>
                <input type="text" id="surahSearch" placeholder="Search Surah...">
            </div>
        </div>

        <nav class="nav-scroll" id="sidebarList">
            </nav>
    </aside>

    <main class="main-content" id="mainScroll">
        <div id="view">
            </div>
    </main>
</div>

<footer class="hud">
    <div class="progress-bar" id="audioProgress"></div>
    <div class="hud-info">
        <div id="currentTrackInfo">
            <div style="font-weight: 700; font-size: 0.9rem;" id="hudSurahName">Zenith Quran</div>
            <div style="font-size: 0.75rem; opacity: 0.6;" id="hudReciterName">Select a Surah to play</div>
        </div>
    </div>
    
    <div class="hud-controls">
        <button onclick="AudioEngine.prev()"><i data-lucide="skip-back"></i></button>
        <button class="play-btn" id="masterPlay" onclick="AudioEngine.toggle()">
            <i data-lucide="play" fill="currentColor"></i>
        </button>
        <button onclick="AudioEngine.next()"><i data-lucide="skip-forward"></i></button>
    </div>

    <div style="display: flex; justify-content: flex-end; gap: 20px;">
        <button id="themeToggle"><i data-lucide="sun"></i></button>
        <button><i data-lucide="settings"></i></button>
    </div>
</footer>
<script>
// ══════════════════════════════════════════════════════════════
// CORE ENGINE: STATE & STORAGE
// ══════════════════════════════════════════════════════════════
const State = {
    currentSurah: null,
    currentAyahs: [],
    allSurahs: [],
    bookmarks: JSON.parse(localStorage.getItem('zenith_bookmarks')) || [],
    goals: JSON.parse(localStorage.getItem('zenith_goals')) || { current: 0, target: 10 },
    settings: {
        reciter: 'ar.alafasy',
        translation: 'en.sahih',
        fontScale: 1
    },

    save(key) {
        localStorage.setItem(`zenith_${key}`, JSON.stringify(this[key]));
    }
};

// ══════════════════════════════════════════════════════════════
// DATA ARCHITECTURE: API WRAPPER
// ══════════════════════════════════════════════════════════════
const API = {
    base: 'https://api.alquran.cloud/v1',

    async fetchJSON(url) {
        try {
            const res = await fetch(url);
            if (!res.ok) throw new Error('Network error');
            const data = await res.json();
            return data.data;
        } catch (err) {
            console.error("API Error:", err);
            UI.toast("Connection failed. Check your internet.");
            return null;
        }
    },

    async getSurahs() {
        if (State.allSurahs.length > 0) return State.allSurahs;
        const data = await this.fetchJSON(`${this.base}/surah`);
        State.allSurahs = data;
        return data;
    },

    async getSurahFull(number) {
        // Fetches Arabic and Translation simultaneously for speed
        return Promise.all([
            this.fetchJSON(`${this.base}/surah/${number}/quran-uthmani`),
            this.fetchJSON(`${this.base}/surah/${number}/${State.settings.translation}`)
        ]);
    },

    getAudioUrl(ayahNumber) {
        // Using the high-quality Alafasy stream
        return `https://cdn.islamic.network/quran/audio/128/ar.alafasy/${ayahNumber}.mp3`;
    }
};

// ══════════════════════════════════════════════════════════════
// SEARCH & FILTER LOGIC
// ══════════════════════════════════════════════════════════════
const Search = {
    init() {
        const input = document.getElementById('surahSearch');
        input.addEventListener('input', (e) => {
            const query = e.target.value.toLowerCase();
            const filtered = State.allSurahs.filter(s => 
                s.englishName.toLowerCase().includes(query) || 
                s.number.toString() === query ||
                s.name.includes(query)
            );
            UI.renderSidebarList(filtered);
        });
    }
};

// ══════════════════════════════════════════════════════════════
// AUDIO ENGINE (Logic Layer)
// ══════════════════════════════════════════════════════════════
const AudioEngine = {
    player: new Audio(),
    currentAyahIndex: 0,
    isPlaying: false,

    init() {
        this.player.addEventListener('ended', () => this.next());
        this.player.addEventListener('timeupdate', () => {
            const progress = (this.player.currentTime / this.player.duration) * 100;
            document.getElementById('audioProgress').style.width = `${progress}%`;
        });
    },

    play(index) {
        if (!State.currentAyahs.length) return;
        this.currentAyahIndex = index;
        const ayah = State.currentAyahs[index];
        
        this.player.src = API.getAudioUrl(ayah.number);
        this.player.play();
        this.isPlaying = true;
        this.updateUI();
    },

    toggle() {
        if (this.isPlaying) {
            this.player.pause();
            this.isPlaying = false;
        } else {
            if (!this.player.src && State.currentAyahs.length > 0) {
                this.play(0);
            } else {
                this.player.play();
                this.isPlaying = true;
            }
        }
        this.updateUI();
    },

    next() {
        if (this.currentAyahIndex < State.currentAyahs.length - 1) {
            this.play(this.currentAyahIndex + 1);
        }
    },

    prev() {
        if (this.currentAyahIndex > 0) {
            this.play(this.currentAyahIndex - 1);
        }
    },

    updateUI() {
        const btn = document.getElementById('masterPlay');
        btn.innerHTML = this.isPlaying ? `<i data-lucide="pause" fill="currentColor"></i>` : `<i data-lucide="play" fill="currentColor"></i>`;
        lucide.createIcons();
    }
};
   // ══════════════════════════════════════════════════════════════
// UI RENDERING ENGINE
// ══════════════════════════════════════════════════════════════
const UI = {
    toast(msg) {
        const t = document.createElement('div');
        t.style = "position:fixed; bottom:110px; right:20px; background:var(--accent); color:white; padding:12px 24px; border-radius:12px; z-index:10000; font-weight:600; box-shadow:0 10px 30px rgba(0,0,0,0.3); animation: slideIn 0.3s ease;";
        t.innerText = msg;
        document.body.appendChild(t);
        setTimeout(() => { t.style.opacity = '0'; setTimeout(() => t.remove(), 500); }, 3000);
    },

    async loadSurah(num) {
        const view = document.getElementById('view');
        view.innerHTML = `<div style="display:grid; place-items:center; height:50vh;"><i data-lucide="loader" class="spin"></i></div>`;
        lucide.createIcons();

        const data = await API.getSurahFull(num);
        if (!data) return;

        const [ar, en] = data;
        State.currentSurah = ar;
        State.currentAyahs = ar.ayahs.map((a, i) => ({
            ...a,
            enText: en.ayahs[i].text
        }));

        this.renderSurah();
        document.getElementById('hudSurahName').innerText = ar.englishName;
        document.getElementById('hudReciterName').innerText = "Mishary Rashid Alafasy";
        
        // Progress tracking
        State.goals.current++;
        State.save('goals');
    },

    renderSurah() {
        const container = document.getElementById('view');
        const surah = State.currentSurah;

        let html = `
            <div class="view-container">
                <div class="surah-header">
                    <div class="ayah-number-badge">SURAH ${surah.number}</div>
                    <h1>${surah.name}</h1>
                    <p style="font-size: 1.2rem; opacity: 0.7;">${surah.englishName} • ${surah.englishNameTranslation}</p>
                    <div style="margin-top: 20px; display: flex; justify-content: center; gap: 15px;">
                        <button onclick="AudioEngine.play(0)" class="play-btn"><i data-lucide="play"></i></button>
                    </div>
                </div>
                <div class="ayah-list">
        `;

        State.currentAyahs.forEach((ayah, index) => {
            html += `
                <div class="ayah-card" id="ayah-${index}">
                    <div class="ayah-number-badge">${ayah.numberInSurah}</div>
                    <div class="ayah-arabic">${ayah.text}</div>
                    <div class="ayah-english">${ayah.enText}</div>
                    <div style="margin-top: 20px; display: flex; gap: 15px; opacity: 0.5;">
                        <button onclick="AudioEngine.play(${index})"><i data-lucide="play" size="18"></i></button>
                        <button><i data-lucide="bookmark" size="18"></i></button>
                        <button><i data-lucide="share-2" size="18"></i></button>
                    </div>
                </div>
            `;
        });

        html += `</div></div>`;
        container.innerHTML = html;
        document.getElementById('mainScroll').scrollTop = 0;
        lucide.createIcons();
    },

    async renderSidebarList(list) {
        const container = document.getElementById('sidebarList');
        const surahs = list || await API.getSurahs();
        
        container.innerHTML = surahs.map(s => `
            <div class="nav-item" onclick="UI.loadSurah(${s.number})">
                <span class="nav-number">${s.number}</span>
                <div class="nav-info">
                    <div class="nav-name">${s.englishName}</div>
                    <div class="nav-sub">${s.name} • ${s.numberOfAyahs} Ayahs</div>
                </div>
            </div>
        `).join('');
    },

    renderHome() {
        document.getElementById('view').innerHTML = `
            <div class="hero">
                <div class="hero-orb" style="top: -100px; right: -100px;"></div>
                <div class="hero-orb" style="bottom: -100px; left: -100px; background: #6366f1;"></div>
                <div style="position: relative; z-index: 1;">
                    <div style="text-transform: uppercase; letter-spacing: 4px; font-size: 0.8rem; font-weight: 700; color: var(--accent); margin-bottom: 15px;">Experience the Divine</div>
                    <h1 class="hero-title">Zenith Pro Ultra</h1>
                    <p style="font-size: 1.2rem; opacity: 0.6; max-width: 600px; margin: 0 auto 40px;">The world's most advanced digital Quran interface. Clean, fast, and beautiful.</p>
                    <button onclick="UI.loadSurah(1)" style="background: var(--accent); color: white; padding: 16px 32px; border-radius: 50px; font-weight: 700; box-shadow: 0 10px 25px var(--accent-glow);">Begin Reading</button>
                </div>
            </div>
        `;
    }
};

// ══════════════════════════════════════════════════════════════
// INITIALIZATION & EVENT LISTENERS
// ══════════════════════════════════════════════════════════════
window.addEventListener('DOMContentLoaded', async () => {
    // Start Services
    await UI.renderSidebarList();
    UI.renderHome();
    Search.init();
    AudioEngine.init();
    lucide.createIcons();

    // Theme Toggle
    document.getElementById('themeToggle').addEventListener('click', () => {
        const html = document.documentElement;
        const isDark = html.getAttribute('data-theme') === 'dark';
        html.setAttribute('data-theme', isDark ? 'light' : 'dark');
        const icon = isDark ? 'moon' : 'sun';
        document.getElementById('themeToggle').innerHTML = `<i data-lucide="${icon}"></i>`;
        lucide.createIcons();
    });
});
</script>

<style>
@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
.spin { animation: spin 1s linear infinite; opacity: 0.5; }
@keyframes slideIn { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
</style>

</body>
</html>
