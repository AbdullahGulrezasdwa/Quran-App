<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sanctuary Quran | Production</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸ“–</text></svg>">
  <script src="https://unpkg.com/lucide@latest"></script>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700&family=Amiri+Quran&display=swap" rel="stylesheet" />
  <style>
    :root {
      /* Theme Defaults (Midnight Slate) */
      --primary: #38bdf8; --bg: #030712; --card: #111827; --text: #f3f4f6; --muted: #9ca3af;
      --border: rgba(255,255,255,0.08); --arabic-font: 'Amiri Quran', serif;
      --nav-w: 100px; --side-w: 400px; --player-h: 110px;
    }

    /* Global Zoom & Scaling */
    html { zoom: 0.67; -moz-transform: scale(0.67); -moz-transform-origin: 0 0; }

    /* Themes */
    body.b-gold { --primary: #fbbf24; --bg: #000; --card: #0a0a0a; }
    body.light { --bg: #ffffff; --card: #f9fafb; --text: #111827; --muted: #6b7280; --border: #e5e7eb; }

    /* Custom Scrollbar */
    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-track { background: var(--bg); }
    ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 20px; border: 2px solid var(--bg); }
    ::-webkit-scrollbar-thumb:hover { background: var(--primary); }

    * { box-sizing: border-box; transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
    body { margin: 0; font-family: 'Plus Jakarta Sans', sans-serif; background: var(--bg); color: var(--text); height: 100vh; display: flex; overflow: hidden; }

    /* NAV & SIDEBAR */
    nav { width: var(--nav-w); border-right: 1px solid var(--border); display: flex; flex-direction: column; align-items: center; padding: 40px 0; gap: 30px; flex-shrink: 0; }
    nav.hidden { margin-left: calc(var(--nav-w) * -1); }
    
    aside { width: var(--side-w); border-left: 1px solid var(--border); background: var(--card); padding: 40px; overflow-y: auto; flex-shrink: 0; }
    aside.hidden { margin-right: calc(var(--side-w) * -1); }

    /* MAIN CONTENT */
    main { flex: 1; overflow-y: auto; position: relative; scroll-padding-top: 100px; }
    .container { max-width: 1200px; margin: 0 auto; padding: 80px 40px 200px 40px; }

    /* LARGE TYPOGRAPHY FOCUS */
    .bismillah { font-family: var(--arabic-font); font-size: 6rem; text-align: center; color: var(--text); margin-bottom: 80px; }
    .ayah-row { padding: 80px 0; border-bottom: 1px solid var(--border); }
    .ayah-row.active { background: rgba(255,255,255,0.02); border-radius: 24px; padding: 80px 40px; margin: 0 -40px; }
    
    .arabic { font-family: var(--arabic-font); font-size: 5rem; direction: rtl; line-height: 2.2; margin-bottom: 30px; display: block; }
    .translation { font-size: 1.8rem; line-height: 1.8; color: var(--muted); font-weight: 300; }
    
    /* BUTTONS & UI */
    .btn { background: var(--card); color: var(--text); border: 1px solid var(--border); padding: 14px 28px; border-radius: 16px; cursor: pointer; font-size: 1.1rem; font-weight: 600; display: inline-flex; align-items: center; gap: 10px; }
    .btn:hover { border-color: var(--primary); background: rgba(255,255,255,0.05); transform: translateY(-2px); }
    .btn-primary { background: var(--primary); color: #000; border: none; }
    
    .nav-icon { color: var(--muted); cursor: pointer; padding: 15px; border-radius: 20px; }
    .nav-icon:hover, .nav-icon.active { color: var(--primary); background: rgba(251, 191, 36, 0.1); }

    /* PLAYER BAR */
    .player-bar { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); width: 90%; max-width: 1400px; height: var(--player-h); background: rgba(10,10,10,0.8); backdrop-filter: blur(20px); border: 1px solid var(--border); border-radius: 30px; display: flex; align-items: center; justify-content: space-between; padding: 0 40px; z-index: 100; box-shadow: 0 20px 50px rgba(0,0,0,0.5); }

    /* DASHBOARD GRID */
    .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 25px; }
    .card { background: var(--card); padding: 30px; border-radius: 24px; border: 1px solid var(--border); cursor: pointer; }
    .card:hover { border-color: var(--primary); }

    /* FOCUS MODE */
    body.focus nav, body.focus aside, body.focus .player-bar { display: none !important; }
    body.focus main { padding-bottom: 0; }
    .exit-focus { position: fixed; top: 40px; right: 40px; z-index: 500; display: none; }
    body.focus .exit-focus { display: flex; }
  </style>
</head>
<body class="b-gold">

  <button class="btn btn-primary exit-focus" onclick="toggleFocus()"><i data-lucide="minimize-2"></i> EXIT FOCUS</button>

  <nav id="navbar">
    <div style="color:var(--primary); margin-bottom: 40px;"><i data-lucide="sparkles" size="32"></i></div>
    <div class="nav-icon active" onclick="updateRoute('home')"><i data-lucide="home" size="28"></i></div>
    <div class="nav-icon" onclick="toggleSidebar()"><i data-lucide="book-open" size="28"></i></div>
    <div class="nav-icon" onclick="toggleFocus()"><i data-lucide="maximize" size="28"></i></div>
    <div style="flex:1"></div>
    <div class="nav-icon" onclick="setTheme()"><i data-lucide="palette" size="28"></i></div>
  </nav>

  <main id="scroll-main">
    <div class="container" id="view-container"></div>
  </main>

  <aside id="sidebar" class="hidden">
    <div style="display:flex; justify-content:space-between; align-items:center;">
        <h2>Insights</h2>
        <button class="btn" style="padding:10px;" onclick="toggleSidebar()"><i data-lucide="x"></i></button>
    </div>
    <div id="side-content" style="margin-top:40px;">
        <div class="card" style="margin-bottom:30px;">
            <h4 style="color:var(--primary)">DAILY HADITH</h4>
            <p id="hadith-text" style="font-size:1.3rem; line-height:1.6; margin-top:15px;">"The best among you are those who learn the Quran and teach it."</p>
        </div>
        <h3>Bookmarks</h3>
        <div id="bookmarks-inner"></div>
    </div>
  </aside>

  <div class="player-bar">
    <div style="width: 300px;">
        <div id="p-title" style="font-size:1.4rem; font-weight:700;">Al-Fatiha</div>
        <div id="p-subtitle" class="text-muted">Mishary Al-Afasy</div>
    </div>
    
    <div style="display:flex; gap:30px; align-items:center;">
        <i data-lucide="skip-back" size="28" style="cursor:pointer"></i>
        <button class="btn-primary" style="width:80px; height:80px; border-radius:50%;" onclick="toggleAudio()">
            <i data-lucide="play" size="32" fill="currentColor"></i>
        </button>
        <i data-lucide="skip-forward" size="28" style="cursor:pointer"></i>
    </div>

    <div style="width: 300px; text-align: right;">
        <button class="btn" onclick="toggleSidebar()">EXPLORE <i data-lucide="chevron-right"></i></button>
    </div>
  </div>

  <audio id="audio-player"></audio>

  <script>
    const App = {
      bookmarks: JSON.parse(localStorage.getItem('sq_bookmarks')) || [],
      async init() {
        lucide.createIcons();
        const res = await fetch('https://api.alquran.cloud/v1/surah');
        const data = await res.json();
        this.chapters = data.data;
        this.router();
      },
      router() {
        const params = new URLSearchParams(window.location.search);
        const surahId = params.get('surah');
        if (surahId) this.renderReader(surahId);
        else this.renderHome();
      },
      renderHome() {
        let html = `<h1 style="font-size:3rem; margin-bottom:60px;">Noble Sanctuary</h1><div class="grid">`;
        html += this.chapters.map(s => `
          <div class="card" onclick="updateRoute('surah', ${s.number})">
            <span style="color:var(--primary); font-weight:800; font-size:1.2rem;">${s.number}</span>
            <h3 style="margin:15px 0; font-size:1.8rem;">${s.englishName}</h3>
            <div style="display:flex; justify-content:space-between; color:var(--muted); font-size:1.1rem;">
                <span>${s.numberOfAyahs} Verses</span>
                <span style="font-family:var(--arabic-font)">${s.name}</span>
            </div>
          </div>
        `).join('') + `</div>`;
        document.getElementById('view-container').innerHTML = html;
        lucide.createIcons();
      },
      async renderReader(id) {
        const container = document.getElementById('view-container');
        container.innerHTML = "<h1>Loading Sanctuary...</h1>";
        const [ar, en] = await Promise.all([
          fetch(`https://api.alquran.cloud/v1/surah/${id}/quran-uthmani`).then(r => r.json()),
          fetch(`https://api.alquran.cloud/v1/surah/${id}/en.sahih`).then(r => r.json())
        ]);
        
        let html = `<button onclick="updateRoute('home')" class="btn" style="margin-bottom:60px;"><i data-lucide="arrow-left"></i> LIBRARY</button>
                    <div class="bismillah">${ar.data.name}</div>`;
        
        ar.data.ayahs.forEach((ayah, i) => {
          html += `<div class="ayah-row" id="ayah-${i}">
            <div class="arabic">${ayah.text} <span style="color:var(--primary); font-size:1.5rem; border:2px solid; padding:5px 15px; border-radius:50%;">${i+1}</span></div>
            <div class="translation">${en.data.ayahs[i].text}</div>
            <div style="margin-top:30px; display:flex; gap:15px;">
                <button class="btn" onclick="App.playVerse(${id}, ${i+1})"><i data-lucide="play-circle"></i> Listen</button>
                <button class="btn" onclick="App.addBookmark(${id}, ${i+1})"><i data-lucide="bookmark"></i> Save</button>
            </div>
          </div>`;
        });
        container.innerHTML = html;
        document.getElementById('p-title').innerText = ar.data.englishName;
        lucide.createIcons();
      },
      playVerse(surah, ayah) {
        // Simple logic for absolute ayah index
        const player = document.getElementById('audio-player');
        player.src = `https://cdn.islamic.network/quran/audio/128/ar.alafasy/1.mp3`; // Placeholder for mapping
        player.play();
      }
    };

    function updateRoute(type, val) {
      const url = new URL(window.location);
      if (type === 'surah') url.searchParams.set('surah', val);
      else url.searchParams.delete('surah');
      window.history.pushState({}, '', url);
      App.router();
    }

    function toggleSidebar() { document.getElementById('sidebar').classList.toggle('hidden'); }
    function toggleFocus() { document.body.classList.toggle('focus'); }
    function setTheme() { 
        document.body.className = document.body.className === 'light' ? 'b-gold' : 'light';
    }

    window.onload = () => App.init();
  </script>
</body>
</html>
