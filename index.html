<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zenith Universal</title>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&family=Amiri+Quran&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #010409; --card: #0d1117; --accent: #38bdf8; --border: rgba(255,255,255,0.1);
            --text: #f0f6fc; --text-dim: #8b949e;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: var(--bg); color: var(--text); display: flex; height: 100vh; overflow: hidden; }

        /* SIDEBAR WITH FIXED SCROLL */
        nav { width: 320px; background: var(--card); border-right: 1px solid var(--border); display: flex; flex-direction: column; height: 100vh; }
        .nav-top { padding: 30px; flex-shrink: 0; }
        .nav-list { flex: 1; overflow-y: auto; padding: 0 20px 120px 20px; scrollbar-width: none; }
        .nav-list::-webkit-scrollbar { display: none; }

        .search-bar { 
            width: 100%; background: rgba(255,255,255,0.05); border: 1px solid var(--border);
            padding: 12px; border-radius: 10px; color: white; outline: none; margin-bottom: 20px;
        }

        .nav-item { 
            width: 100%; padding: 14px 18px; border-radius: 12px; display: flex; align-items: center; gap: 12px; 
            color: var(--text-dim); cursor: pointer; border: none; background: transparent; 
            margin-bottom: 5px; font-weight: 600; font-size: 0.9rem; transition: 0.2s;
        }
        .nav-item:hover, .nav-item.active { background: rgba(56, 189, 248, 0.1); color: var(--accent); }
        .nav-item.active { border-left: 4px solid var(--accent); }

        /* MAIN CONTENT */
        main { flex: 1; overflow-y: auto; scroll-behavior: smooth; padding-bottom: 150px; }
        .container { max-width: 900px; margin: 0 auto; padding: 60px 40px; }

        /* CARDS & VERSES */
        .card { 
            background: rgba(255,255,255,0.02); border: 1px solid var(--border);
            padding: 30px; border-radius: 20px; margin-bottom: 20px; transition: 0.3s;
        }
        .card:hover { border-color: var(--accent); transform: translateY(-3px); }
        .ar { font-family: 'Amiri Quran'; font-size: 2.8rem; direction: rtl; text-align: left; line-height: 1.8; margin: 20px 0; }

        /* HUD */
        .hud { 
            position: fixed; bottom: 25px; left: 345px; right: 25px; 
            background: rgba(13, 17, 23, 0.95); backdrop-filter: blur(20px);
            border-radius: 20px; padding: 20px 30px; display: flex; align-items: center; gap: 20px;
            border: 1px solid var(--border); z-index: 9999;
        }
        .p-btn { background: var(--accent); color: #000; width: 45px; height: 45px; border-radius: 50%; display: grid; place-items: center; cursor: pointer; border: none; }

        .label { font-size: 0.65rem; font-weight: 800; color: var(--text-dim); margin: 25px 0 10px 10px; text-transform: uppercase; }
        .btn-mini { padding: 8px 15px; border-radius: 8px; border: 1px solid var(--border); background: transparent; color: var(--text-dim); cursor: pointer; font-size: 0.7rem; font-weight: 700; margin-right: 8px; }
        .btn-mini:hover { border-color: var(--accent); color: var(--accent); }
    </style>
</head>
<body>

<nav id="sidebar">
    <div class="nav-top">
        <div style="font-size: 1.6rem; font-weight: 900; color: var(--accent); margin-bottom: 25px;">ZENITH PRO</div>
        <input type="text" class="search-bar" id="search" placeholder="Search Surah...">
    </div>
    <div class="nav-list">
        <div class="label">Navigation</div>
        <button class="nav-item active" data-action="home"><i data-lucide="layout"></i> Dashboard</button>
        <button class="nav-item" data-action="reading"><i data-lucide="book-open"></i> Reading Mode</button>
        <button class="nav-item" data-action="favs"><i data-lucide="heart"></i> Favorites</button>
        
        <div class="label">Tools</div>
        <button class="nav-item" data-action="reciters"><i data-lucide="mic-2"></i> Reciters</button>
        <button class="nav-item" data-action="trans"><i data-lucide="languages"></i> Translations</button>
        <button class="nav-item" data-action="settings"><i data-lucide="settings"></i> Settings</button>
        
        <div class="label">Session</div>
        <button class="nav-item" style="color:#f87171" onclick="location.reload()"><i data-lucide="refresh-cw"></i> Reset App</button>
    </div>
</nav>

<main id="scroller">
    <div class="container" id="view"></div>
</main>

<div class="hud">
    <button class="p-btn" id="master-play"><i data-lucide="play"></i></button>
    <div style="flex:1">
        <div id="p-meta" style="font-size:0.75rem; font-weight:800; color:var(--accent); margin-bottom:8px">READY</div>
        <div style="height:4px; background:rgba(255,255,255,0.05); border-radius:10px; overflow:hidden">
            <div id="p-fill" style="height:100%; width:0%; background:var(--accent)"></div>
        </div>
    </div>
</div>

<audio id="audio"></audio>

<script>
const App = {
    surahs: [],
    audio: document.getElementById('audio'),

    async init() {
        const res = await fetch('https://api.alquran.cloud/v1/surah');
        const data = await res.json();
        this.surahs = data.data;
        this.renderHome();
        this.bindGlobalEvents();
        lucide.createIcons();
    },

    bindGlobalEvents() {
        // Sidebar Click Handler
        document.getElementById('sidebar').addEventListener('click', (e) => {
            const btn = e.target.closest('.nav-item');
            if (!btn) return;
            document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
            btn.classList.add('active');
            const action = btn.dataset.action;
            if (action === 'home') this.renderHome();
            else alert(`${action} coming soon in this version!`);
        });

        // Search Handler
        document.getElementById('search').addEventListener('input', (e) => {
            const query = e.target.value.toLowerCase();
            const filtered = this.surahs.filter(s => s.englishName.toLowerCase().includes(query));
            this.renderHome(filtered);
        });

        // Audio HUD Handler
        document.getElementById('master-play').addEventListener('click', () => {
            if (!this.audio.src) return;
            this.audio.paused ? this.audio.play() : this.audio.pause();
            this.updateIcons();
        });

        this.audio.ontimeupdate = () => {
            document.getElementById('p-fill').style.width = (this.audio.currentTime / this.audio.duration * 100) + '%';
        };
    },

    renderHome(list = this.surahs) {
        document.getElementById('view').innerHTML = `
            <h1 style="font-size:3rem; margin-bottom:40px">Library</h1>
            <div style="display:grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap:20px">
                ${list.map(s => `
                    <div class="card" onclick="App.openSurah(${s.number})">
                        <span style="color:var(--accent); font-size:0.7rem; font-weight:800">#${s.number}</span>
                        <h2 style="margin:10px 0">${s.englishName}</h2>
                        <div style="font-family:'Amiri Quran'; text-align:right; color:var(--accent); font-size:1.8rem">${s.name}</div>
                    </div>
                `).join('')}
            </div>`;
    },

    async openSurah(num) {
        const [ar, en] = await Promise.all([
            fetch(`https://api.alquran.cloud/v1/surah/${num}/quran-uthmani`).then(r => r.json()),
            fetch(`https://api.alquran.cloud/v1/surah/${num}/en.sahih`).then(r => r.json())
        ]);

        const isBismillahSurah = (num !== 1 && num !== 9);
        let html = `
            <button class="btn-mini" onclick="App.renderHome()">← Library</button>
            <div style="text-align:center; margin: 40px 0 80px 0">
                <h1 style="font-family:'Amiri Quran'; font-size:5rem; color:var(--accent)">${ar.data.name}</h1>
                ${isBismillahSurah ? `<div style="font-family:'Amiri Quran'; font-size:2.5rem; opacity:0.5; margin-top:20px">بِسْمِ ٱللَّهِ ٱلرَّحْمَٰنِ ٱلرَّحِيمِ</div>` : ''}
            </div>`;

        ar.data.ayahs.forEach((v, i) => {
            let text = v.text;
            if (isBismillahSurah && i === 0) text = text.replace("بِسْمِ ٱللَّهِ ٱلرَّحْمَٰنِ ٱلرَّحِيمِ ", "");
            
            html += `
                <div class="card">
                    <div style="background:var(--accent); color:#000; padding:3px 10px; border-radius:5px; font-size:0.6rem; font-weight:900; width:fit-content; margin-bottom:15px">AYAH ${i+1}</div>
                    <p class="ar">${text}</p>
                    <p style="color:var(--text-dim); line-height:1.6">${en.data.ayahs[i].text}</p>
                    <div style="margin-top:20px">
                        <button class="btn-mini" onclick="App.playAyah(${v.number}, ${i+1})">PLAY</button>
                        <button class="btn-mini">SAVE</button>
                        <button class="btn-mini">COPY</button>
                    </div>
                </div>`;
        });

        document.getElementById('view').innerHTML = html;
        document.getElementById('scroller').scrollTop = 0;
        lucide.createIcons();
    },

    playAyah(num, idx) {
        this.audio.src = `https://cdn.islamic.network/quran/audio/128/ar.alafasy/${num}.mp3`;
        this.audio.play();
        document.getElementById('p-meta').innerText = `RECITING AYAH ${idx}`;
        this.updateIcons();
    },

    updateIcons() {
        const icon = document.querySelector('#master-play i');
        icon.setAttribute('data-lucide', this.audio.paused ? 'play' : 'pause');
        lucide.createIcons();
    }
};

App.init();
</script>
</body>
</html>
